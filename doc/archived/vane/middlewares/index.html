
<!DOCTYPE html>
<html>
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app22.us.archive.org';v.server_ms=274;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/static/js/ait-client-rewrite.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript">
WB_wombat_Init('https://web.archive.org/web', '20150302011044', 'www.dartvoid.com:80');
</script>
<script type="text/javascript" src="/static/js/wbhack.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript">
__wbhack.init('https://web.archive.org/web');
</script>
<link rel="stylesheet" type="text/css" href="/static/css/banner-styles.css?v=1544499711.0" />
<link rel="stylesheet" type="text/css" href="/static/css/iconochive.css?v=1544499711.0" />
<!-- End Wayback Rewrite JS Include -->

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="DartVoid is an application hosting platform for Dart. Deploy your full-stack Dart applications in a simple way today.">
  <meta itemprop="name" content="DartVoid · Middlewares">
  <meta itemprop="description" content="DartVoid is an application hosting platform for Dart. Deploy your full-stack Dart applications in a simple way today.">
  <meta itemprop="image" content="http://www.dartvoid.com/assets/img/dartvoid-figure-horizontal-500x695.png">
  <meta property="og:title" content="DartVoid · Middlewares">
  <meta property="og:image" content="https://web.archive.org/web/20150302011044im_/http://www.dartvoid.com/assets/img/dartvoid-figure-horizontal-500x695.png">
  <meta property="og:description" content="DartVoid is an application hosting platform for Dart. Deploy your full-stack Dart applications in a simple way today.">

  <meta name="alexaVerifyID" content="c_dKvoAIWBKjpCK9Kla5E8AzQX4"/>
  <meta name="google-site-verification" content="6Yq4U5ZHy1LdfnOX-UsyVgHaeBKWNQlp8V3K3mCln3M"/>

  <title>DartVoid &middot; Middlewares</title>

  <!-- Site CSS -->
  <link rel="stylesheet" href="/web/20150302011044cs_/http://www.dartvoid.com:80/assets/css/bundle.css">
    
  <!-- Favicon -->
  <link rel="shortcut icon" href="/web/20150302011044im_/http://www.dartvoid.com:80/assets/img/ico/favicon.png">
  
  <style type="text/css">
    @font-face {
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 400;
      src: url(https://web.archive.org/web/20150302011044im_/https://themes.googleusercontent.com/static/fonts/roboto/v10/CrYjSnGjrRCn0pd9VQsnFOvvDin1pK8aKteLpeZ5c0A.woff) format('woff');
    }
  </style>

  <!-- Zendesk Widget -->
  <script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("//web.archive.org/web/20150302011044/http://assets.zendesk.com/embeddable_framework/main.js","dartvoid.zendesk.com");/*]]>*/</script>

</head>
<body onload="prettyPrint()"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/timestamp.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/graph-calc.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/auto-complete.js?v=1544499711.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/toolbar.js?v=1544499711.0" charset="utf-8"></script>
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
.wb-autocomplete-suggestions {
    text-align: left; cursor: default; border: 1px solid #ccc; border-top: 0; background: #fff; box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute; display: none; z-index: 2147483647; max-height: 254px; overflow: hidden; overflow-y: auto; box-sizing: border-box;
}
.wb-autocomplete-suggestion { position: relative; padding: 0 .6em; line-height: 23px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 1.02em; color: #333; }
.wb-autocomplete-suggestion b { font-weight: bold; }
.wb-autocomplete-suggestion.selected { background: #f0f0f0; }
</style>
<div id="wm-ipp" lang="en" style="display:none;direction:ltr;">
<div style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:130px;padding-top:10px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a href="#"
             onclick="__wm.saveSnapshot('http://www.dartvoid.com:80/vane/middlewares/', '20150302011044')"
             title="Share via My Web Archive"
             id="wm-save-snapshot-open"
          >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" style="text-align:right;">
	<a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://web.archive.org/web/20150302011044/http://www.dartvoid.com:80/vane/middlewares/', '', 'height=400,width=600'); return false;" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=https://web.archive.org/web/20150302011044/http://www.dartvoid.com:80/vane/middlewares/&amp;via=internetarchive', '', 'height=400,width=600'); return false;" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://www.dartvoid.com:80/vane/middlewares/" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20150302011044" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20141127204429/http://www.dartvoid.com:80/vane/middlewares/" title="27 Nov 2014"><strong>Nov</strong></a></td>
		  <td class="c" id="displayMonthEl" title="You are here: 01:10:44 Mar 02, 2015">MAR</td>
		  <td class="f" nowrap="nowrap">Apr</td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20141127204429/http://www.dartvoid.com:80/vane/middlewares/" title="20:44:29 Nov 27, 2014"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 01:10:44 Mar 02, 2015">02</td>
		  <td class="f" nowrap="nowrap"><img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" /></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap">2014</td>
		  <td class="c" id="displayYearEl" title="You are here: 01:10:44 Mar 02, 2015">2015</td>
		  <td class="f" nowrap="nowrap">2016</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20150302011044*/http://www.dartvoid.com:80/vane/middlewares/" title="See a list of every capture for this URL">3 captures</a>
	      <div class="r" title="Timespan for captures of this URL">25 May 2014 - 02 Mar 2015</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="600" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
            <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/static/images/loading.gif" alt="loading" /></div>
    </div>
  </div></div></div></div><script type="text/javascript">
__wm.bt(600,27,25,2,"web","http://www.dartvoid.com:80/vane/middlewares/","2015-03-02",1996);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

  <div class="navbar navbar-default navbar-static-top dartvoid-nav" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-collapse-header">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a href="/web/20150302011044/http://www.dartvoid.com:80/" class="navbar-brand">
          <svg class="navbar-brand-logo" xmlns="http://www.w3.org/2000/svg" preserveaspectratio="xMidYMid meet" viewbox="10 0 1064 350">
            <g>
            <path d="M54.406 169.06c0 82.495 66.874 149.365 149.368 149.365 82.49 0 149.364-66.87 149.364-149.365 0-82.497-66.874-149.367-149.364-149.367-82.494 0-149.368 66.87-149.368 149.367" fill="#3a80cb"/>
            <path d="M94.058 169.06c0 71.543 58 129.54 129.542 129.54 71.543 0 129.538-57.997 129.538-129.54 0-71.547-57.995-129.54-129.538-129.54S94.058 97.512 94.058 169.06" fill="#4ba5e0"/>
            <path d="M45.08 88.038l383.71 66.89v5.28H12.393c-7.8 0 29.794-71.662 32.687-72.17" fill="#55c5a9"/>
            <path d="M45.08 255.723l383.71-66.885v-5.28H12.393c-7.8 0 29.794 71.664 32.687 72.165" fill="#55c5a9"/>
            <path d="M244.867 218.15l183.924-32.06v-2.532H229.204c-3.734 0 14.278 34.355 15.664 34.592" fill="#80d4c2"/>
            <path d="M244.867 125.615l183.924 32.06v2.534H229.204c-3.734 0 14.278-34.354 15.664-34.595" fill="#80d4c2"/>
            <text style="line-height:125%" x="446.542" y="639.781" font-size="152.715" letter-spacing="0" word-spacing="0" fill="#3a80cb" font-family="'Roboto', sans-serif" transform="translate(0 -407.48)"><tspan style="text-align:start;line-height:125%; x=" 446.542" y="639.781" font-size="152.715" fill="#3a80cb" font-family="'Roboto', sans-serif">Dart<tspan style="text-align:start;line-height:125%; font-size=" 152.715" fill="#55c5a9" font-family="'Roboto', sans-serif">Void</tspan></tspan></text><text style="line-height:125%" x="765.185" y="430.792" font-size="125.086" letter-spacing="0" word-spacing="0" fill="#55c5a9" font-family="'Roboto', sans-serif" transform="translate(0 -407.48)"/>
            </g>
          </svg>
        </a>
      </div>

      <nav class="collapse navbar-collapse navbar-collapse-header" role="navigation">
        <div class="navbar-right">
          <ul class="nav navbar-nav">
            <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/docs/">Documentation</a></li>
            <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/community/">Community</a></li>
            <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/company/">Company</a></li>
          </ul>
          <ul class="nav navbar-nav">
            <li><a href="https://web.archive.org/web/20150302011044/https://manage.dartvoid.com/"><i class="fa fa-sign-in"></i> Sign in</a></li>
            <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/signup/">Sign up</a></li>
          </ul>
        </div>
      </nav>
    </div>
  </div>

  <div class="navbar navbar-default navbar-static-top dartvoid-subnav" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".navbar-collapse-subheader">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>

      <nav class="collapse navbar-collapse navbar-collapse-subheader" role="navigation">
        <ul class="nav navbar-nav">
          <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/vane/">Overview</a></li>
          <li class="active"><a href="/web/20150302011044/http://www.dartvoid.com:80/vane/middlewares/">Middlewares</a></li>
          <li class=""><a href="/web/20150302011044/http://www.dartvoid.com:80/vane/databases/">Database access</a></li>
          <li><a href="/web/20150302011044/http://www.dartvoid.com:80/docs/vaneapi/">API <i class="fa fa-external-link"></i></a></li>
          <li><a href="https://web.archive.org/web/20150302011044/https://github.com/DartVoid/Vane" target="_blank">Source <i class="fa fa-external-link"></i></a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="container-page content">
    <header class="jumbotron dartvoid-jumbotron">
      <div class="container">
        <h1><strong>Middlewares</strong></h1>
        <p class="lead"></p>
      </div>
    </header>

    <div class="container">
      <div class="col-md-8 docs-left">
        
<h2 id="introduction-to-middlewares">Introduction to Middlewares</h2>

<p>Any class that extends <code>Vane</code> can be used as either the main handler or as a middleware handler. 
You can have all your handler logic in one class or you can separate them into 
multiple Vane classes that you configure to run in an order of your choosing. </p>

<p>Vane’s middleware implementation has four goals:</p>

<ol>
  <li>Enhance code reuse between projects and within apps</li>
  <li>Make it easier and less verbose to structure combinations of synchronous and asynchronous code</li>
  <li>Make it easier to debug big or complex handlers</li>
  <li>Make middleware classes lightweight </li>
</ol>

<p>The middleware functionally in Vane can be thought of as a tool to help structure synchronous and asynchronous structures 
that otherwise could can be hard (or verbose) to structure in a single function in Dart (eg. when you get too many “and then, and then, and then, and then”). </p>

<p>The asynchronous nature of Dart is very powerful, but sometimes it’s simply better to separate parts of the code that should run synchronously after 
each other in different functions/classes.</p>

<p>Middlewares can be registered to run either before or after the main handler. To register the middlewares order of execution you need to implement 
a member called <code>pipeline</code> as a <code>List</code> in your main handler. To help with defining the position for the main handler, 
Vane exposes <code>This</code> which reflects the handlers own name.</p>

<p>Middlewares in Vane run synchronously by default, but you can choose to run some or all middleware asynchronously to create the optimal chain of classes for your handler. 
Asynchronous middleware classes that are registered after each other are started in async until the first synchronous class comes in the chain, 
then Vane will wait for all the asynchronous classes to finish before it continues with the next synchronous class. 
If you want your class to run asynchronously you just declare a member called <code>async</code> in your class and set it to <code>true</code>. </p>

<p>Any class in your handler chain can at it’s end, either run <code>close()</code> or <code>next()</code>. <code>close()</code> will close the request and the response will be returned to 
the client, if any middleware handler or the main handler calls <code>close()</code> the handlers registered after it will not run. If a handler calls <code>next()</code> 
instead of <code>close()</code>, then the next handler will continue to run. 
If you have a handler or middleware at the end of the <code>pipeline</code> that calls <code>next()</code> Vane converts it to a <code>close()</code> to prevent the server from hanging.</p>

<p>Vane’s middleware classes are lightweight, what that means is that you don’t have to worry that your handler gets slow because you add many 
middleware classes. Behind the scenes the main handler and the middleware classes share most of the “heavy parts”. Vane has a core object that 
hold things like the request data, the request body and the request response. When a middleware class should run, it will not get a copy of all this data, 
but a reference to the core Vane object. Because of this we believe that you should not have to consider running code inside 
middleware classes a performance hit, not big enough to care about anyways.</p>

<p>It should be noted that when we talk about running code synchronous and asynchronous we only refer to the order middleware and the main handler 
runs in respect to each other. Code inside handlers runs like any dart code, mostly asynchronously that is.</p>

<h2 id="tube">Tube</h2>
<p>Tube is a middleware communication layer that allows an application to communicate between the different middlewares and the main handler.</p>

<p>There are two ways to communicate through Tube:</p>

<ul>
  <li>Add data events to a stream </li>
  <li>Send data to a message queue</li>
</ul>

<div class="row">
  <div class="col-md-6">
    <h3 id="stream-data">Stream data</h3>
    <p>Tubes stream combines a sink and a stream to broadcast messages. 
Stream data events with <code>add</code> and then <code>listen</code> for the data.</p>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [HelloMiddleware, This];

  @Route(&quot;/&quot;)
  Future main() {
    tube.listen((data) {
      write(&quot;Hello ${data[&quot;name&quot;]}!&quot;);
      return close();
    });

    return end;
  }
}

class HelloMiddleware extends Vane {
  Future main() {
    tube.add({&quot;name&quot;: &quot;testuser&quot;});
    return next();
  }
}

void main() =&gt; serve();
</pre>
  </div>

  <div class="col-md-6">
    <h3 id="queue-messages">Queue messages</h3>

    <p>Tubes message queue uses a <a href="https://web.archive.org/web/20150302011044/https://en.wikipedia.org/wiki/FIFO">FIFO</a> (first in, first out) approach. 
Simply add messages to the queue with <code>send</code> and use <code>recieve</code> to read messages one at a time from the bottom.  </p>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [HelloMiddleware, This];

  @Route(&quot;/&quot;)
  Future main() {
    var data = tube.receive();
    write(&quot;Hello ${data[&quot;name&quot;]}!&quot;);
    return close();
  }
}

class HelloMiddleware extends Vane {
  Future main() {
    tube.send({&quot;name&quot;: &quot;testuser&quot;});
    return next();
  }
}

void main() =&gt; serve();
</pre>
  </div>
</div>

<h2 id="execution-order">Execution order</h2>

<p>By defining the order in the <code>pipeline</code> you can control the applications flow. 
To allow for middlewares to run after the main handler it needs to return <code>next()</code> instead of <code>close()</code>, 
and because Vane can convert the last <code>next()</code> to a <code>close()</code> there isn’t any risk of hanging your 
server if you choose to change the order of execution later on.</p>

<div class="row">
  <div class="col-md-6">
    <h3 id="before-main-handler">Before main handler</h3>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [HelloMiddleware, This];

  @Route(&quot;/&quot;)
  Future main() {
    writeln(&quot;Hello World!&quot;);
    return close();
  }
}

class HelloMiddleware extends Vane {
  Future main() {
    writeln(&quot;Hello middle earth!&quot;);
    return next();
  }
}

void main() =&gt; serve();
</pre>
  </div>
  <div class="col-md-6">
    <h3 id="after-main-handler">After main handler</h3>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [This, HelloMiddleware];

  @Route(&quot;/&quot;)
  Future main() {
    writeln(&quot;Hello World!&quot;);
    // Allows the middleware to run
    return next(); 
  }
}

class HelloMiddleware extends Vane {
  Future main() {
    writeln(&quot;Hello middle earth!&quot;);
    return next();
  }
}

void main() =&gt; serve();
</pre>
  </div>
</div>

<h2 id="switching-between-synchronous-and-asynchronous-behavior">Switching between synchronous and asynchronous behavior</h2>
<p>If you want to switch between running your middleware synchronously and asynchronously (when you debug for example) 
then you can just change the <code>bool</code> value of the <code>async</code> member that all Vane handlers inherit. 
If you switch very often and have many different classes then you could add a default constructor to your middleware class where you setup the async member.</p>

<p>In the following examples we simulate a workload with <code>Timer</code> and log each request with the <code>pIndex</code> (pipeline index).</p>

<div class="row">
  <div class="col-md-6">
    <h3 id="synchronous">Synchronous</h3>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [
    SyncMiddleware, 
    SyncMiddleware, 
    This
  ];

  @Route(&quot;/hello&quot;)
  Future main() {
    writeln(&quot;Hello World!&quot;);
    log.info(&quot;Main $pIndex&quot;);
    return next();
  }
}

class SyncMiddleware extends Vane {
  Future main() {
    new Timer(new Duration(seconds: 1), () {
      writeln(&quot;Hello sync earth!&quot;);
      log.info(&quot;Sync $pIndex&quot;);
      next();
    });

    return end;
  }
}

void main() =&gt; serve();
</pre>

  </div>
  <div class="col-md-6">
    <h3 id="asynchronous">Asynchronous</h3>

    <pre class="prettyprint lang-dart">
import &#39;dart:async&#39;; 
import &#39;package:vane/vane.dart&#39;;

class HelloWorld extends Vane {
  var pipeline = [
    AsyncMiddleware, 
    AsyncMiddleware, 
    This
  ];

  @Route(&quot;/hello&quot;)
  Future main() {
    writeln(&quot;Hello World!&quot;);
    log.info(&quot;Main $pIndex&quot;);
    return next();
  }
}

class AsyncMiddleware extends Vane {
  var async = true;
  
  Future main() {
    new Timer(new Duration(seconds: 1), () {
      writeln(&quot;Hello async earth!&quot;);
      log.info(&quot;Async $pIndex&quot;);
      next();
    });

    return end;
  }
}

void main() =&gt; serve();
</pre>
  </div>
</div>


      </div>
    </div>
  </div>
  <div class="dartvoid-footer">
    <div class="container">
      <div class="row">

        <div class="col-md-3 col-sm-12 footer-columns">
          <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
              <a href="/web/20150302011044/http://www.dartvoid.com:80/" class="navbar-brand">
                <svg class="navbar-brand-logo" xmlns="http://www.w3.org/2000/svg" preserveaspectratio="xMidYMid meet" viewbox="10 0 1064 350">
                <g>
                  <path d="M54.406 169.06c0 82.495 66.874 149.365 149.368 149.365 82.49 0 149.364-66.87 149.364-149.365 0-82.497-66.874-149.367-149.364-149.367-82.494 0-149.368 66.87-149.368 149.367" fill="#3a80cb"/>
                  <path d="M94.058 169.06c0 71.543 58 129.54 129.542 129.54 71.543 0 129.538-57.997 129.538-129.54 0-71.547-57.995-129.54-129.538-129.54S94.058 97.512 94.058 169.06" fill="#4ba5e0"/>
                  <path d="M45.08 88.038l383.71 66.89v5.28H12.393c-7.8 0 29.794-71.662 32.687-72.17" fill="#55c5a9"/>
                  <path d="M45.08 255.723l383.71-66.885v-5.28H12.393c-7.8 0 29.794 71.664 32.687 72.165" fill="#55c5a9"/>
                  <path d="M244.867 218.15l183.924-32.06v-2.532H229.204c-3.734 0 14.278 34.355 15.664 34.592" fill="#80d4c2"/>
                  <path d="M244.867 125.615l183.924 32.06v2.534H229.204c-3.734 0 14.278-34.354 15.664-34.595" fill="#80d4c2"/>
                  <text style="line-height:125%" x="446.542" y="639.781" font-size="152.715" letter-spacing="0" word-spacing="0" fill="#3a80cb" font-family="'Roboto', sans-serif" transform="translate(0 -407.48)"><tspan style="text-align:start;line-height:125%; x=" 446.542" y="639.781" font-size="152.715" fill="#3a80cb" font-family="'Roboto', sans-serif">Dart<tspan style="text-align:start;line-height:125%; font-size=" 152.715" fill="#55c5a9" font-family="'Roboto', sans-serif">Void</tspan></tspan></text><text style="line-height:125%" x="765.185" y="430.792" font-size="125.086" letter-spacing="0" word-spacing="0" fill="#55c5a9" font-family="'Roboto', sans-serif" transform="translate(0 -407.48)"/>
                  </g>
                </svg>
              </a>
            </div>
            <div class="col-md-12 col-sm-12 col-xs-12">
              <span class="navbar-brand-subtext">Copyright &copy; 2014 DartVoid</span>
            </div>
          </div>
        </div>

        <div class="col-md-3 col-sm-4 col-xs-6 footer-columns">
          <h4>Company</h4>
          <ul>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/company/">About Us</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/http://blog.dartvoid.com/" target="_blank">Blog</a></li>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/community">Events</a></li>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/company/contact/">Contact</a></li>
          </ul>
        </div>

        <div class="col-md-3 col-sm-4 col-xs-6 footer-columns">
          <h4>Resources</h4>
          <ul>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/docs/getting-started/">Getting started</a></li>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/docs/">Documentation</a></li>
            <li><a href="/web/20150302011044/http://www.dartvoid.com:80/vane/">Vane</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/https://api.dartlang.org/" target="_blank"><i class="fa fa-external-link"></i> Dartlang API</a></li>
          </ul>
        </div>
        
        <div class="col-md-3 col-sm-4 col-xs-6 footer-columns">
          <h4>Communication</h4>
          <ul>
            <li><a href="https://web.archive.org/web/20150302011044/mailto:contact@dartvoid.com?subject=Hello"><i class="fa fa-envelope"></i> Email</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/https://plus.google.com/+Dartvoid/" target="_blank"><i class="fa fa-google-plus"></i> Google+</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/https://twitter.com/DartVoid/" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/https://github.com/DartVoid/" target="_blank"><i class="fa fa-github"></i> Github</a></li>
            <li><a href="https://web.archive.org/web/20150302011044/http://www.hipchat.com/gdLik3cWq" target="_blank"><i class="fa fa-comment"></i> Hipchat</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Bootstrap JS -->
  <script type="text/javascript" src="//web.archive.org/web/20150302011044js_/http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script type="text/javascript" src="/web/20150302011044js_/http://www.dartvoid.com:80/assets/js/bootstrap.min.js"></script>
    
  <!-- Prettify JS -->
  <script type="text/javascript" src="/web/20150302011044js_/http://www.dartvoid.com:80/assets/js/prettify.js"></script>
  <script type="text/javascript" src="/web/20150302011044js_/http://www.dartvoid.com:80/assets/js/lang-dart.js"></script>
  <script type="text/javascript" src="/web/20150302011044js_/http://www.dartvoid.com:80/assets/js/lang-yaml.js"></script>

  <!-- GA JS-->
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//web.archive.org/web/20150302011044/http://www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-35167322-1', 'dartvoid.com');
    ga('send', 'pageview');
  </script>

  <!-- GPLUS JS-->
  <script type="text/javascript">
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://web.archive.org/web/20150302011044/https://apis.google.com/js/platform.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>

  <!-- Twitter JS-->
  <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

  <!-- Knowledge Graph -->
  <script type="application/ld+json">
    {
      "@context" : "https://web.archive.org/web/20150302011044/http://schema.org/",
      "@type" : "Organization",
      "name" : "DartVoid",
      "url" : "https://web.archive.org/web/20150302011044/http://www.dartvoid.com/",
      "sameAs" : [
        "https://web.archive.org/web/20150302011044/https://plus.google.com/+Dartvoid",
        "https://web.archive.org/web/20150302011044/https://twitter.com/DartVoid",
        "https://web.archive.org/web/20150302011044/https://github.com/DartVoid"
      ]
    }
  </script>

</body>
</html>

<!--
     FILE ARCHIVED ON 01:10:44 Mar 02, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:07:28 Jan 17, 2019.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  LoadShardBlock: 108.908 (3)
  esindex: 0.006
  captures_list: 123.315
  CDXLines.iter: 10.387 (3)
  PetaboxLoader3.datanode: 147.157 (4)
  exclusion.robots: 0.4
  exclusion.robots.policy: 0.383
  RedisCDXSource: 1.018
  PetaboxLoader3.resolve: 36.092
  load_resource: 106.466
-->
